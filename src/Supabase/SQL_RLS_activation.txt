ALTER TABLE public.auth_users ENABLE ROW LEVEL SECURITY;
ALTER TABLE public.user_profiles ENABLE ROW LEVEL SECURITY;
ALTER TABLE public.worker_types ENABLE ROW LEVEL SECURITY;
ALTER TABLE public.auth_sessions ENABLE ROW LEVEL SECURITY;
ALTER TABLE public.security_audit_log ENABLE ROW LEVEL SECURITY;

-- Policy for admin access to auth_users table
CREATE POLICY admin_access_auth_users ON public.auth_users
FOR ALL
USING (
  EXISTS (
    SELECT 1 FROM public.user_profiles
    WHERE auth_user_id = auth.uid() AND role = 'admin'
  )
);

-- Policy for admin access to user_profiles table
CREATE POLICY admin_access_user_profiles ON public.user_profiles
FOR ALL
USING (
  EXISTS (
    SELECT 1 FROM public.user_profiles
    WHERE auth_user_id = auth.uid() AND role = 'admin'
  )
);

-- Policy for admin access to worker_types table
CREATE POLICY admin_access_worker_types ON public.worker_types
FOR ALL
USING (
  EXISTS (
    SELECT 1 FROM public.user_profiles
    WHERE auth_user_id = auth.uid() AND role = 'admin'
  )
);

-- Policy for admin access to auth_sessions table
CREATE POLICY admin_access_auth_sessions ON public.auth_sessions
FOR ALL
USING (
  EXISTS (
    SELECT 1 FROM public.user_profiles
    WHERE auth_user_id = auth.uid() AND role = 'admin'
  )
);

-- Policy for admin access to security_audit_log table
CREATE POLICY admin_access_security_audit_log ON public.security_audit_log
FOR ALL
USING (
  EXISTS (
    SELECT 1 FROM public.user_profiles
    WHERE auth_user_id = auth.uid() AND role = 'admin'
  )
);
